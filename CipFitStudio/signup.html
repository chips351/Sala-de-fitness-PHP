<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Signup</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Montserrat', sans-serif;
        }
    </style>
</head>

<body class="min-h-screen flex justify-center items-center bg-[url('imagini/dumbells.jpg')] bg-cover bg-center py-20">

    <div class="bg-gradient-to-b from-black/50 to-white/50 
                backdrop-blur-sm shadow-xl rounded-3xl 
                p-10 w-[450px] flex flex-col items-center">

        <form id="signupForm" action="signup.php" method="POST" class="w-full flex flex-col items-center">

            <!-- Logo + Name -->
            <a href="homepage.php" class="flex items-center gap-6 mb-10 no-underline cursor-pointer hover:opacity-90">
                <img src="imagini/logo.png" alt="CipFit logo" class="h-20 w-auto object-contain drop-shadow-lg" />
                <div class="w-[1.3px] h-16 bg-black drop-shadow-lg"></div>
                <div class="text-left drop-shadow-lg">
                    <p class="text-4xl font-extrabold text-black drop-shadow-lg">CipFit</p>
                    <p class="text-xl font-semibold text-black drop-shadow-lg">Studio</p>
                </div>
            </a>

            <p class="text-2xl font-bold text-black mb-8">Creează un cont</p>

            <!-- Name -->
            <div class="w-full mb-5">
                <label class="block text-gray-700 font-medium mb-1">Nume complet *</label>
                <input type="text" name="name"
                    class="w-full h-12 px-4 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Ex: Andrei Popescu" />
            </div>

            <div class="w-full mb-5">
                <label class="block text-gray-700 font-medium mb-1">Username *</label>
                <input type="text" name="username" 
                    class="w-full h-12 px-4 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Ex: andrei123" />
            </div>

            <!-- Email -->
            <div class="w-full mb-5">
                <label class="block text-gray-700 font-medium mb-1">Email *</label>
                <input type="email" name="email"
                    class="w-full h-12 px-4 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Introdu email-ul" />
            </div>

            <!-- Telefon -->
            <div class="w-full mb-5">
                <label class="block text-gray-700 font-medium mb-1">Telefon</label>
                <input type="text" name="phone"
                    class="w-full h-12 px-4 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="07xx xxx xxx" />
            </div>

            <!-- Rol -->
            <div class="w-full mb-5">
                <label class="block text-gray-700 font-medium mb-1">Rol *</label>
                <select name="role"
                    class="w-full h-12 px-4 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500">
                    <option value="" disabled selected>Selectează rolul</option>
                    <option value="client">Client</option>
                    <option value="trainer">Antrenor</option>
                </select>
            </div>

            <!-- Parola -->
            <div class="w-full mb-2 relative">
                <label class="block text-left text-gray-700 font-medium mb-1">Password *</label>

                <input type="password" name="password"
                    class="w-full h-12 px-4 pr-12 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Introdu parola" />

                <button type="button" class="absolute right-3 top-[42px] w-6 h-6 opacity-90"
                    onclick="const i=this.parentElement.querySelector('input'); i.type = i.type === 'password' ? 'text' : 'password';">
                    <img src="imagini/see_password.png" alt="See password" class="w-full h-full object-contain" />
                </button>
            </div>

            <!-- Confirmare parola -->
            <div class="w-full mb-2 relative">
                <label class="block text-left text-gray-700 font-medium mb-1">Password *</label>

                <input type="password" name="confirm_password"
                    class="w-full h-12 px-4 pr-12 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Introdu parola" />

                <button type="button" class="absolute right-3 top-[42px] w-6 h-6 opacity-90"
                    onclick="const i=this.parentElement.querySelector('input'); i.type = i.type === 'password' ? 'text' : 'password';">
                    <img src="imagini/see_password.png" alt="See password" class="w-full h-full object-contain" />
                </button>
            </div>

            <button type="submit"
                class="w-full bg-black text-white text-lg font-bold py-3 rounded-lg hover:scale-105 transition">
                Creează cont
            </button>

            <div id="message" class="text-red-600 font-medium mt-2"></div>

            <p class="text-sm text-black mt-4">
                Ai deja un cont?
                <a href="login.html" class="font-semibold hover:underline">Loghează-te aici</a>
            </p>

            <script>
                const form = document.getElementById('signupForm');
                const messageDiv = document.getElementById('message');

                form.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    const fd = new FormData(form);

                    try {
                        const res = await fetch('signup.php', {
                            method: 'POST',
                            body: fd
                        });

                        let data;
                        try { data = await res.json(); } catch (e) { data = null; }

                        if (data && data.success) {
                            messageDiv.textContent = '';
                            messageDiv.classList.remove('text-red-600');
                            messageDiv.classList.add('text-green-600');
                            messageDiv.textContent = data.message || 'Cont creat!';
                            setTimeout(() => {
                                window.location.href = data.redirect || 'login.html';
                            }, 1500);
                        } else if (data && !data.success) {
                            messageDiv.classList.remove('text-green-600');
                            messageDiv.classList.add('text-red-600');
                            messageDiv.textContent = data.message || 'Eroare la creare cont.';
                        } else {
                            const text = await res.text();
                            messageDiv.classList.remove('text-green-600');
                            messageDiv.classList.add('text-red-600');
                            messageDiv.textContent = 'A apărut o eroare. Detaliu: ' + text.slice(0, 200);
                        }

                    } catch (err) {
                        console.error(err);
                        messageDiv.classList.remove('text-green-600');
                        messageDiv.classList.add('text-red-600');
                        messageDiv.textContent = 'A apărut o eroare de rețea. Încearcă din nou.';
                    }
                });
            </script>
        </form>
    </div>

</body>

</html>