<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Login Client</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
        }
    </style>
</head>

<body class="min-h-screen flex justify-center items-center bg-[url('imagini/dumbells.jpg')] bg-cover bg-center py-20">
    <div class="bg-gradient-to-b from-black/50 to-white/50
            backdrop-blur-sm shadow-xl rounded-3xl 
            p-10 w-[450px] flex flex-col items-center">

        <!-- Logo + Name -->
        <a href="homepage.html" class="flex items-center gap-6 mb-10 no-underline cursor-pointer hover:opacity-90">
            <img src="imagini/logo.png" alt="CipFit logo" class="h-20 w-auto object-contain drop-shadow-lg" />
            <div class="w-[1.3px] h-16 bg-black drop-shadow-lg"></div>
            <div class="text-left drop-shadow-lg">
                <p class="text-4xl font-extrabold text-black drop-shadow-lg">CipFit</p>
                <p class="text-xl font-semibold text-black drop-shadow-lg">Studio</p>
            </div>
        </a>

        <!-- Title -->
        <p class="text-2xl font-bold text-black mb-8">Login client</p>

        <!-- Form start -->
        <form id="loginForm" action="login.php" method="POST" class="w-full flex flex-col items-center">

            <!-- Username Input -->
            <div class="w-full mb-5">
                <label class="block text-left text-gray-700 font-medium mb-1">Username</label>
                <input type="text" name="username"
                    class="w-full h-12 px-4 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Introdu username-ul" />
            </div>

            <!-- Password Input -->
            <div class="w-full mb-5 relative">
                <label class="block text-left text-gray-700 font-medium mb-1">Password</label>
                <input type="password" name="password"
                    class="w-full h-12 px-4 pr-12 bg-white rounded-lg shadow focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="Introdu parola" />
                <button type="button" class="absolute right-3 top-[42px] w-6 h-6 opacity-90"
                    onclick="const i=this.parentElement.querySelector('input'); i.type = i.type === 'password' ? 'text' : 'password';">
                    <img src="imagini/see_password.png" alt="See password" class="w-full h-full object-contain" />
                </button>
            </div>

            <!-- Forgot password -->
            <a href="#" class="text-sm text-black/80 font-semibold mt-1 mb-6 hover:underline">
                Forgot password?
            </a>

            <!-- Submit button -->
            <button type="submit"
                class="w-full bg-black text-white text-lg font-bold py-3 rounded-lg hover:scale-105 transition">
                Login
            </button>

            <div id="message" class="text-red-600 font-medium mt-2"></div>

            <script>
                const form = document.getElementById('loginForm');
                const messageDiv = document.getElementById('message');
                
                form.addEventListener('submit', function(event) {
                    event.preventDefault(); // opreste refresh
                    const formattedFormData = {
                        username: this.username.value,
                        password: this.password.value
                    }
                    postData(formattedFormData);
                });
                
                async function postData(formattedFormData) {
                    try {
                        const response = await fetch('login.php', { //apelam login.php
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(formattedFormData)
                        });

                        const data = await response.json(); //raspunsul din login.php

                        if (data && data.success) {
                            window.location.href = data.redirect || 'homepage.html';
                        } else {
                            if (data && data.message) {
                                messageDiv.textContent = data.message;
                            } else {
                                messageDiv.textContent = 'Login failed';
                            }
                        }
                    } catch (err) {
                        console.error(err);
                        messageDiv.textContent = 'Network error';
                    }
                }
            </script>
        </form>
    </div>
</body>

</html>